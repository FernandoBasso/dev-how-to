<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2018-07-15 dom 05:03 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Modules</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Fernando Basso">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style> code {background-color: #fefefe; border: 1px solid #ccc;  border-radius: 3px; padding: 2px; }</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Modules</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgf164b0d">1. Intro</a></li>
<li><a href="#org9c0abc8">2. module instance method</a>
<ul>
<li><a href="#org1b381dd">2.1. Method Overriding</a></li>
</ul>
</li>
<li><a href="#orgd5e134a">3. Inheritance</a></li>
<li><a href="#orgc8eeda6">4. Method Lookup</a></li>
<li><a href="#orgabb27ec">5. include vs prepend</a></li>
<li><a href="#orga76bd17">6. super keyword to call parent class method</a></li>
<li><a href="#org4df39b5">7. method_missing</a></li>
<li><a href="#orgf76ed4b">8. Some design principles</a></li>
<li><a href="#org95e2b4e">9. Nesting and the double-colon</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgf164b0d" class="outline-2">
<h2 id="orgf164b0d"><span class="section-number-2">1</span> Intro</h2>
<div class="outline-text-2" id="text-1">
<p>
Modules are bundles of methods and constants. You add a module to a class to endow the class with extra functionality.
</p>

<p>
Modules are similar to classes (but we can't create instances of modules), so much that the <code>Class</code> class is a subclass of the <code>Module</code> class, and that means that every class object is also a module object.
</p>

<p>
<code>Kernel</code> is a module that contains many of the methods that are common to all objects, including <code>load</code> and <code>require</code>.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Greeter</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">hi</span>
    <span style="color: #CC9393;">'Hi there.'</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Message</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Greeter</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

msg = <span style="color: #7CB8BB;">Message</span>.new
<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.hi
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "Hi there."</span>
</pre>
</div>

<p>
We defined the method <code>hi</code> in the <code>Greeter</code> module like if it were an instance method of a class, and by including the module in the <code>Message</code> class, we can use that method in instances of that class as if they were defined as instance methods of the class itself.
</p>

<p>
In Ruby, we can inherit from a single parent class at a time, but we can include (mix in) multiple modules at once.
</p>


<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">StackIt</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">stack</span>
    <span style="color: #DFAF8F;">@stack</span> ||= []
  <span style="color: #F0DFAF; font-weight: bold;">end</span>

  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">stack_add</span>(obj)
    stack.push(obj)
  <span style="color: #F0DFAF; font-weight: bold;">end</span>

  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">stack_pop</span>
    stack.pop
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">OurStack</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">StackIt</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

stk = <span style="color: #7CB8BB;">OurStack</span>.new
stk.stack_add(<span style="color: #CC9393;">'PHP'</span>)
stk.stack_add(<span style="color: #CC9393;">'JavaScript'</span>)
<span style="color: #DCDCCC; font-weight: bold;">p</span> stk.stack
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; ["PHP", "JavaScript"]</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> stk.stack_pop
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "JavaScript</span>

stk.stack_add(<span style="color: #CC9393;">'Haskell'</span>)
stk.stack_add(<span style="color: #CC9393;">'Ruby'</span>)
<span style="color: #DCDCCC; font-weight: bold;">p</span> stk.stack
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; ["PHP", "Haskell", "Ruby"]</span>
</pre>
</div>

<pre class="example">
["PHP", "JavaScript"]
"JavaScript"
["PHP", "Haskell", "Ruby"]

</pre>

<p>
<code>@stack</code> in <code>StackIt</code> module behaves like if it were defined in <code>OutStack</code> class. Now we could use it in any class, not just in <code>OutStack</code>.
</p>


<p>
Class names should generally be a noun, and module names should generally be an adjective. There must be good reasons to not follow this convention on any given situation.
</p>
</div>
</div>


<div id="outline-container-org9c0abc8" class="outline-2">
<h2 id="org9c0abc8"><span class="section-number-2">2</span> module instance method</h2>
<div class="outline-text-2" id="text-2">
<p>
This module has an instance method:
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Pluralable</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">pluralize</span>(word, count, plural = <span style="color: #BFEBBF;">nil</span>)
    <span style="color: #F0DFAF; font-weight: bold;">return</span> word <span style="color: #F0DFAF; font-weight: bold;">if</span> 1 == count
    <span style="color: #F0DFAF; font-weight: bold;">return</span> plural <span style="color: #F0DFAF; font-weight: bold;">if</span> plural
    <span style="color: #F0DFAF; font-weight: bold;">return</span> <span style="color: #CC9393;">"</span><span style="color: #DFAF8F;">#{count}</span><span style="color: #CC9393;"> </span><span style="color: #DFAF8F;">#{word}</span><span style="color: #CC9393;">s"</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Message</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Pluralable</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

msg = <span style="color: #7CB8BB;">Message</span>.new
<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.pluralize(<span style="color: #CC9393;">'apple'</span>, 0)
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "0 apples"</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.pluralize(1, <span style="color: #CC9393;">'apple'</span>)
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "1 apple"</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.pluralize(<span style="color: #CC9393;">'apple'</span>, 2)
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "2 apples"</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.pluralize(<span style="color: #CC9393;">'foot'</span>, 0, <span style="color: #CC9393;">'feet'</span>)
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "0 feet"</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.pluralize(<span style="color: #CC9393;">'foot'</span>, 1)
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "1 foot"</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.pluralize(<span style="color: #CC9393;">'foot'</span>, 2, <span style="color: #CC9393;">'feet'</span>)
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "0 feet"</span>
</pre>
</div>

<p>
The method <code>pluralize</code> in the <code>Pluralable</code> module is an instance method of that module, and when it gets <i>mixed into</i> (included) into the class <code>Message</code> that class can use the module as if it were and instance method of the class itself. What happens is that there is a module lookup going on. When something like a method or variable can't be found on a class, the lookup mechanism looks in parent classes and included modules to try to find the variable or method.
</p>

<p>
Even if a super super super class includes a module that contains a certain method, the current object will be able to invoke that method.
</p>

<p>
If a method is not found, the result is an error condition that triggers the call of the method <code>method_missing</code> (and we can override it to customize what happens when this method is invoked).
</p>

<p>
<code>BasicObject</code> is the first class in the hierarchy, then we have the <code>Object</code> class, and <code>Kernel</code> is a module that <code>Object</code> mixes in.
</p>

<p>
All classes that inherit from <code>Object</code> automatically inherit stuff provided by <code>Kernel</code>.
</p>

<p>
TODO: Draw some diagram about this hierarchy of modules and classes to insert at this point.
</p>
</div>

<div id="outline-container-org1b381dd" class="outline-3">
<h3 id="org1b381dd"><span class="section-number-3">2.1</span> Method Overriding</h3>
<div class="outline-text-3" id="text-2-1">
<p>
When a module (or a class) define the same method name more than once, the last one wins.
</p>
</div>
</div>
</div>


<div id="outline-container-orgd5e134a" class="outline-2">
<h2 id="orgd5e134a"><span class="section-number-2">3</span> Inheritance</h2>
<div class="outline-text-2" id="text-3">
<p>
When we create our classes, we don't need to explicitly inherit from <code>Object</code>. That is done automatically.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">This class has access to all stuff defined in</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Object and Kernl.</span>
  <span style="color: #5F7F5F;">#</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Person</span>.superclass
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; Object</span>

<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Person</span>.class
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; Class</span>
</pre>
</div>

<pre class="example">
Object
Class

</pre>


<p>
Remember that doing <code>class Foo ... end</code> is the same as <code>Foo = Class.new do ... end</code>, and that the former notation is syntax sugar the latter. So, <code>Person</code> is an <i>instance</i> of <code>Class</code> (so <code>Person</code> is indeed also an object on its own right), and it inherits from <code>Object</code>. And <code>Object</code> mixes in the module <code>Kernel</code> Read more at <a href="https://ruby-doc.org/core-2.5.1/Object.html">the Ruby docs for the <code>Object</code> class</a>.
</p>

<p>
Okay, so, if Ruby can only inherit from a single class at a time, that means if we now instantiate a <code>Teacher</code> class and make it inherit from <code>Person</code>, then <code>Teacher</code> does not inherit from <code>Object</code>?
</p>

<p>
Because <code>Person</code> inherits from <code>Object</code>, and <code>Teacher</code> inherits from <code>Person</code>, that means <code>Teacher</code> also have access to stuff defined in the <code>Object</code> class, which also means it has access to things defined in <code>Kernel</code> (because <code>Object</code> mixes <code>Kernel</code> in). In short, a descendant has access to all the stuff from any of its ancestors.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Inherits from Object (which inherits from BasicObject) and</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">includes the module Kernel.</span>

  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">initialize</span>(name)
    <span style="color: #DFAF8F;">@name</span> = name
  <span style="color: #F0DFAF; font-weight: bold;">end</span>

  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">tell_name</span>
    <span style="color: #CC9393;">"My name is </span><span style="color: #DFAF8F;">#{@name}</span><span style="color: #CC9393;">"</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Teacher</span> &lt; <span style="color: #7CB8BB;">Person</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">tell_profession</span>
    <span style="color: #CC9393;">'I am a teacher.'</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

person = <span style="color: #7CB8BB;">Person</span>.new(<span style="color: #CC9393;">'Lara Croft'</span>)
teacher = <span style="color: #7CB8BB;">Teacher</span>.new(<span style="color: #CC9393;">'Verner Von Coy'</span>)

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Instances of ~Person~ have access to `respond_to?' (from `Kernel').</span>
<span style="color: #F0DFAF; font-weight: bold;">if</span> person.respond_to?(<span style="color: #BFEBBF;">:tell_profession</span>)
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">This won't execute becase `Person` doesn't</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">have the method `tell_profession'.</span>
  <span style="color: #DCDCCC; font-weight: bold;">p</span> person.tell_profession
<span style="color: #F0DFAF; font-weight: bold;">else</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">This will be executed.</span>
  <span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #CC9393;">'Person cannot tell the profession.'</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">if</span> teacher.respond_to?(<span style="color: #BFEBBF;">:tell_profession</span>)
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">This will be executed.</span>
  <span style="color: #DCDCCC; font-weight: bold;">p</span> teacher.tell_profession
<span style="color: #F0DFAF; font-weight: bold;">else</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">This else block won't run because Teacher has the</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">method `tell_profession`</span>
  <span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #CC9393;">'Teacher cannot tell profession.'</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>
</pre>
</div>

<pre class="example">
"Person cannot tell the profession."
"I am a teacher."

</pre>
</div>
</div>


<div id="outline-container-orgc8eeda6" class="outline-2">
<h2 id="orgc8eeda6"><span class="section-number-2">4</span> Method Lookup</h2>
<div class="outline-text-2" id="text-4">
<p>
An object can only ‚Äúsee‚Äù one method with a given name at a time. The object‚Äôs lookup mechanism stops at the first name that matches. The lookup mechanism walks from the inner to the outer definitions, which means inner definitions win.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Greetable</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">say_hello</span>
    <span style="color: #CC9393;">"Hello from module `Greetable'."</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Message</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Greetable</span>

  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">say_hello</span>
    <span style="color: #CC9393;">"Hello from class `Message'."</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

msg = <span style="color: #7CB8BB;">Message</span>.new
<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.say_hello
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "Hello from module `Greetable'."</span>
</pre>
</div>

<pre class="example">
"Hello from class `Message'."

</pre>

<p>
The method <code>say_hello</code> in the class <code>Message</code> ‚Äúwins‚Äù, because the lookup mechanism will start with the class that gave birth to the object <code>msg</code>, and only if it doesn‚Äôt find the method there will it look further in the lookup chain.
</p>

<p>
If two or more included modules define the same method, the most recent included one (the last included) wins.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Mod1</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">hello</span>
    <span style="color: #CC9393;">'Hello from mod1.'</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Mod2</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">hello</span>
    <span style="color: #CC9393;">'Hello from mod2.'</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Foo</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Mod1</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Mod2</span> <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">included last, wins</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Bar</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Mod2</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Mod1</span> <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">included last, wins</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

foo = <span style="color: #7CB8BB;">Foo</span>.new
<span style="color: #DCDCCC; font-weight: bold;">p</span> foo.hello
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "Hello from mod2."</span>

bar = <span style="color: #7CB8BB;">Bar</span>.new
<span style="color: #DCDCCC; font-weight: bold;">p</span> bar.hello
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "Hello from mod1."</span>
</pre>
</div>

<pre class="example">
"Hello from mod2."
"Hello from mod1."

</pre>


<p>
Also important to be aware that including the method more than once doesn‚Äôt actually re-include it. Ruby detects that it was already in the load path and simply ignores it.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Foo</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Mod1</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Mod2</span> <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Considered the last included.</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Mod1</span> <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Won&#8217;t be re-included.</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgabb27ec" class="outline-2">
<h2 id="orgabb27ec"><span class="section-number-2">5</span> include vs prepend</h2>
<div class="outline-text-2" id="text-5">
<p>
When we <code>prepend</code> modules in a class (instead of using <code>include</code>, the lookup mechanism searches for methods in the modules first, and only then in the class.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Greetable</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">hello</span>
    <span style="color: #CC9393;">"Hello from the module `Greeter'."</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Message</span>
  <span style="color: #DCDCCC; font-weight: bold;">prepend</span> <span style="color: #7CB8BB;">Greetable</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">hello</span>
    <span style="color: #CC9393;">"Hello from the class `Message'."</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

msg = <span style="color: #7CB8BB;">Message</span>.new
<span style="color: #DCDCCC; font-weight: bold;">p</span> msg.hello
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">&#8594; "Hello from the module `Greeter'."</span>
</pre>
</div>

<pre class="example">
"Hello from the module `Greeter'."

</pre>

<p>
Even though the class <code>Message</code> defines a method with the same name as the method defined in the mixed in module, because we used <code>prepend</code> rather than <code>include</code>, the method defined in the module ‚Äúwins‚Äù. With <code>include</code>, the version defined in the class would win.
</p>

<p>
We can use <code>ClassName.ancestors</code> to see an ordered list of <i>places</i> where an object will look for method.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Greetable</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Message</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Greetable</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">show_ancestors</span>
    <span style="color: #F0DFAF; font-weight: bold;">self</span>.class.ancestors
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Alert</span>
  <span style="color: #DCDCCC; font-weight: bold;">prepend</span> <span style="color: #7CB8BB;">Greetable</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">show_ancestors</span>
    <span style="color: #F0DFAF; font-weight: bold;">self</span>.class.ancestors
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #5F7F5F;">#</span><span style="color: #7F9F7F;">p Message.ancestors</span>
<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Message</span>.ancestors
<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Message</span>.new.class.ancestors
<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Message</span>.new.show_ancestors

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Note that for `Alert' (which we used `prepend'), `Greetable'</span>
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">appears _before_ the `Alert' class itself.</span>
<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Alert</span>.ancestors
<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Alert</span>.new.class.ancestors
<span style="color: #DCDCCC; font-weight: bold;">p</span> <span style="color: #7CB8BB;">Alert</span>.new.show_ancestors
</pre>
</div>

<pre class="example">
[Message, Greetable, Object, Kernel, BasicObject]
[Message, Greetable, Object, Kernel, BasicObject]
[Message, Greetable, Object, Kernel, BasicObject]
[Greetable, Alert, Object, Kernel, BasicObject]
[Greetable, Alert, Object, Kernel, BasicObject]
[Greetable, Alert, Object, Kernel, BasicObject]

</pre>

<p>
And there we have an overview of the lookup path for a class using <code>include</code> vs <code>prepend</code> to mix a module in. In short, we use <code>prepend</code> when we want a method defined in the module take precedence over the method of the same name defined in the class. And remember that modules are included and prepended are searched for in reverse order. Something like a LIFO (Last In, First Out).
</p>

<p>
See the docs on <code>Module#inclue</code> and <code>Module#prepend</code>. Use <code>pry</code>'s <code>show-doc</code> or look in docs.ruby-lang.org.
</p>



<p>
<code>self.class.ancestors</code> will display the classes and modules that compose the current object.
</p>

<pre class="example">
[14:47:44] &lt;FernandoBasso&gt; Inside method defined inside a module, is there a self.&lt;something&gt; that would show the name of the module?
[14:48:31] &lt;FernandoBasso&gt; Like, in a class method, I can do self.class and it shows the name of the class in which the method is defined. Can I show the name of the module in which the module is defined in a similar fashion?
[14:48:40] &lt;apeiros&gt; self.class.ancestors will contain it
[14:49:05] &lt;FernandoBasso&gt; I see. Thanks.
[14:49:37] &lt;apeiros&gt; but since a method is always invoked in the context of the receiver, there's nothing which will tell you "this is the method defined in module X"
[14:50:22] &lt;apeiros&gt; well, to a degree you can use source_location and/or method(__method__).owner, both have their issues and limitations.
[14:50:26] &lt;apeiros&gt; what do you try to achieve?
[14:51:38] &lt;FernandoBasso&gt; Nothing in particular. Just trying to understand self better, and the relation between modules and classes.
[14:52:39] &lt;apeiros&gt; self is the object in which's (whose?) context the current code is executed.
[14:53:47] &lt;FernandoBasso&gt; So far, I figure it is, in some ways, similar to `this' in javascript. Its value depending on how the code is executed, and not set in stone upon definition.
[14:54:26] &lt;apeiros&gt; it's exactly as `this` in js. js just differs in when context of `this` changes.
</pre>
</div>
</div>


<div id="outline-container-orga76bd17" class="outline-2">
<h2 id="orga76bd17"><span class="section-number-2">6</span> super keyword to call parent class method</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">greet</span>
    <span style="color: #DCDCCC; font-weight: bold;">puts</span> <span style="color: #CC9393;">'Hello from a nice Person.'</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Programmer</span> &lt; <span style="color: #7CB8BB;">Person</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">greet</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Invokes `greet' from the superclass (parent class).</span>
    <span style="color: #F0DFAF; font-weight: bold;">super</span>
    <span style="color: #DCDCCC; font-weight: bold;">puts</span> <span style="color: #CC9393;">'Hello from a nice Programmer.'</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #7CB8BB;">Programmer</span>.new.greet()
</pre>
</div>

<pre class="example">
Hello from a nice Person.
Hello from a nice Programmer.

</pre>

<p>
So, unlike most other OO languages, in Ruby you can not only invoke the superclass constructor, but also invoke any of the superclass methods.
</p>

<p>
Let's see a somewhat more realist example, when we invoke the consturctor of the superclass (because it already does part of what we want for the subclass), and then do the rest of the necessary work on the subclass itself. Let's say a person has name and email, and a programmer, which is a person, also have a lang skill.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span>
  <span style="color: #DCDCCC; font-weight: bold;">attr_reader</span> <span style="color: #BFEBBF;">:name</span>, <span style="color: #BFEBBF;">:email</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">initialize</span>(name, email)
    <span style="color: #DFAF8F;">@name</span> = name
    <span style="color: #DFAF8F;">@email</span> = email
  <span style="color: #F0DFAF; font-weight: bold;">end</span>

  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">to_s</span>
    <span style="color: #CC9393;">"</span><span style="color: #DFAF8F;">#{@name}</span><span style="color: #CC9393;">, </span><span style="color: #DFAF8F;">#{@email}</span><span style="color: #CC9393;">"</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Programmer</span> &lt; <span style="color: #7CB8BB;">Person</span>
  <span style="color: #DCDCCC; font-weight: bold;">attr_reader</span> <span style="color: #BFEBBF;">:lang</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">initialize</span>(name, email, lang)
    <span style="color: #F0DFAF; font-weight: bold;">super</span>(name, email)
    <span style="color: #DFAF8F;">@lang</span> = lang
  <span style="color: #F0DFAF; font-weight: bold;">end</span>

  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">to_s</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Let's also use to_s from the parent class, which already does</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">part of the job we need.</span>
    <span style="color: #CC9393;">"</span><span style="color: #DFAF8F;">#{super}</span><span style="color: #CC9393;">, </span><span style="color: #DFAF8F;">#{@lang}</span><span style="color: #CC9393;">"</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

torvalds = <span style="color: #7CB8BB;">Programmer</span>.new(<span style="color: #CC9393;">'Linus Torvalds'</span>, <span style="color: #CC9393;">'linus@kernel.org'</span>, <span style="color: #CC9393;">'C'</span>)
norvig = <span style="color: #7CB8BB;">Programmer</span>.new(<span style="color: #CC9393;">'Peter Norvig'</span>, <span style="color: #CC9393;">'norvig@commonlisp.org'</span>, <span style="color: #CC9393;">'Common Lisp'</span>)

<span style="color: #DCDCCC; font-weight: bold;">p</span> torvalds.to_s
<span style="color: #DCDCCC; font-weight: bold;">p</span> norvig.to_s
</pre>
</div>

<pre class="example">
"Linus Torvalds, linus@kernel.org, C"
"Peter Norvig, norvig@commonlisp.org, Common Lisp"

</pre>


<p>
The keyword <code>super</code> (yes, it is a keyword, not a method) was engineered to have special behavior when it comes to passing arguments to the parent's class method.
</p>

<ul class="org-ul">
<li>With no arguments, meaning, the <i>bareword</i> <code>super</code>, all arguments are automaticall forwarded to the parent class method.</li>
<li>With an empty argument list like <code>super()</code>, no arguments are forwarded to the parent class method, even if the current method is passed arguments.</li>
<li>With specific arguments, like ~super(arg1, arg2), only those specific arguments are passed to the parent class method.</li>
</ul>


<p>
Note that we can't do this:
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">initialize</span>(name, email)
    <span style="color: #DFAF8F;">@name</span> = name
    <span style="color: #DFAF8F;">@email</span> = email
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Programmer</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">initialize</span>(name, email, lang)
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Can't just call `super' to forward all the args because we would be</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">forwarding three args, and Person's constructor expects only two</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">args, which would produce an error.</span>
    <span style="color: #F0DFAF; font-weight: bold;">super</span> <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">No, this won't work.</span>
    <span style="color: #DFAF8F;">@lang</span> = lang
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #5F7F5F;">#</span><span style="color: #7F9F7F;">Programmer.new('John Carmack', 'carmack@idsoftware.com', 'C++')</span>
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">`initialize': wrong number of arguments (given 3, expected 0) (ArgumentError)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org4df39b5" class="outline-2">
<h2 id="org4df39b5"><span class="section-number-2">7</span> method_missing</h2>
<div class="outline-text-2" id="text-7">
<p>
Let's intercept messages an object doesn't understand and do something about it.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">method_missing</span>(name, *args)
    <span style="color: #DCDCCC; font-weight: bold;">puts</span> <span style="color: #CC9393;">"Method `</span><span style="color: #DFAF8F;">#{name}</span><span style="color: #CC9393;">' is not defined on </span><span style="color: #DFAF8F;">#{self.class}</span><span style="color: #CC9393;">."</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">We won't see Ruby's deault message for undefined methods or local variables.</span>
<span style="color: #7CB8BB;">Person</span>.new.i_dont_exist()
</pre>
</div>

<pre class="example">
Method `i_dont_exist' is not defined on Person.

</pre>

<p>
We can also use our own <code>method_missing</code> implementation to do something if the missing method matches a particular pattern and invoke the default Ruby <code>method_missing</code> method otherwise.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Greet</span>
  <span style="color: #F0DFAF; font-weight: bold;">def</span> <span style="color: #93E0E3;">method_missing</span>(method, *args)
    <span style="color: #F0DFAF; font-weight: bold;">if</span> method.to_s.start_with?(<span style="color: #CC9393;">'end'</span>)
      <span style="color: #DCDCCC; font-weight: bold;">puts</span> <span style="color: #CC9393;">'Kind regards'</span>
    <span style="color: #F0DFAF; font-weight: bold;">else</span>
      <span style="color: #F0DFAF; font-weight: bold;">super</span>
    <span style="color: #F0DFAF; font-weight: bold;">end</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">begin</span>
  greet = <span style="color: #7CB8BB;">Greet</span>.new
  greet.end_letter
  greet.end_chat
  greet.end_message
  greet.close_message
<span style="color: #F0DFAF; font-weight: bold;">rescue</span> <span style="color: #7CB8BB;">Exception</span> =&gt; msg
  <span style="color: #DCDCCC; font-weight: bold;">puts</span> <span style="color: #CC9393;">'Oops, got an exception &#128169;'</span>
  <span style="color: #DCDCCC; font-weight: bold;">p</span> msg
<span style="color: #F0DFAF; font-weight: bold;">end</span>
</pre>
</div>

<pre class="example">
Kind regards
Kind regards
Kind regards
Oops, got an exception üí©
#&lt;NoMethodError: undefined method `close_message' for #&lt;Greet:0x0000555bfef7f620&gt;&gt;

</pre>
</div>
</div>


<div id="outline-container-orgf76ed4b" class="outline-2">
<h2 id="orgf76ed4b"><span class="section-number-2">8</span> Some design principles</h2>
<div class="outline-text-2" id="text-8">
<p>
An object doesn't care if a method was defined the class that created the object, or any superclass of that class, or in a mixed in module. It only cares that the method exists.
</p>

<p>
Althouh we can defined mehtods inside a module, and then every class in the world could reuse the code defined in the module, be careful not to overmodularize everything just for the sake of it.
</p>

<p>
Sometimes it is better to have a superclass that provides some basic and general functionality, and sometimes it is better to have a module and mix it in intead. Just remember than modules cannot be instantiated (and a class which acts as a superclass can be instantiated), while on the other hand you can inherit from a single class at a time, whereas we can include multiple modules at a time.
</p>

<p>
Classes are generally named with <i>nouns</i>, and modules are often named with <i>adjectives</i>, like the <code>Message</code> class vs the <code>Greetable</code> module, or <code>Array</code> class vs the <code>Enumerable</code> module, etc.
</p>

<p>
In this example, a inheritance is a better approach than including a module:
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Do this (good approach)</span>
<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Student</span> &lt; <span style="color: #7CB8BB;">Person</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Teacher</span> &lt; <span style="color: #7CB8BB;">Person</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Instead of (bad approach)</span>
<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Student</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">PersonLike</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Teacher</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">PersonLine</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>
</pre>
</div>

<p>
In this example, it is more advisable to use a module to include greet-capabilities. A person can greet someone else, but a robot, a program, etc, can greet too.
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Poor choice:</span>
<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Greet</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Some greet-related methods...R</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span> &lt; <span style="color: #7CB8BB;">Greet</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Student</span> &lt; <span style="color: #7CB8BB;">Greet</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Cyborg</span> &lt; <span style="color: #7CB8BB;">Greet</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Do this instead:</span>
<span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Greetable</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Some greet-related methods...</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Person</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Greetable</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Student</span> &lt; <span style="color: #7CB8BB;">Person</span>
  <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">It has access to Greetable as well since it descends from Person.</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Cyborg</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Greetable</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>
</pre>
</div>

<p>
Another, example, from the Well Grounded Rubyist book:
</p>

<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Completely wrong! Please, dear programmer, you are embarrassing yourself...</span>
<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">SelfPropelling</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Truck</span> &lt; <span style="color: #7CB8BB;">SelfPropelling</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">Vehicle</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Do this instead, no questions asked. Just follow my lead.</span>
<span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">SelfPropelling</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Vehicle</span>
  <span style="color: #DCDCCC; font-weight: bold;">include</span> <span style="color: #7CB8BB;">SelfPropelling</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

<span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Truck</span> &lt; <span style="color: #7CB8BB;">Vehicle</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org95e2b4e" class="outline-2">
<h2 id="org95e2b4e"><span class="section-number-2">9</span> Nesting and the double-colon</h2>
<div class="outline-text-2" id="text-9">
<div class="org-src-container">
<pre class="src src-ruby"><span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Shapes</span>
  <span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Circle</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Model circles.</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>

  <span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Rectangle</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Model rectangles.</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>

circle = <span style="color: #7CB8BB;">Shapes</span>::<span style="color: #7CB8BB;">Circle</span>.new
rect = <span style="color: #7CB8BB;">Shapes</span>::<span style="color: #7CB8BB;">Rectangle</span>.new

<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">And then we could have Circle and Rectangle in another namespace and no</span>
<span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">name collision would occur.</span>
<span style="color: #F0DFAF; font-weight: bold;">module</span> <span style="color: #7CB8BB;">Collision</span>
  <span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Circle</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Circle-related collision detection.</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>

  <span style="color: #F0DFAF; font-weight: bold;">class</span> <span style="color: #7CB8BB;">Rectangle</span>
    <span style="color: #5F7F5F;"># </span><span style="color: #7F9F7F;">Rectangle-related collision detection.</span>
  <span style="color: #F0DFAF; font-weight: bold;">end</span>
<span style="color: #F0DFAF; font-weight: bold;">end</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Fernando Basso</p>
<p class="date">Created: 2018-07-15 dom 05:03</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
