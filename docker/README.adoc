= Docker
:page-subtitle: Containers
:page-tags: docker container linux unix
:favicon: https://fernandobasso.dev/cmdline.png
:icons: font
:sectlinks:
:sectnums!:
:toclevels: 6
:toc: left
:source-highlighter: highlight.js
:imagesdir: __assets
:stem: latexmath
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]


== ArchLinux on MacOS m2

.Dockerfile before

[source,bash]
----
FROM --platform=linux/x86_64 archlinux:latest
CMD ["echo", "It works!"]
----

[source,text]
----
$ docker build --tag hello:latest --file ./Dockerfile1 .
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  73.73kB
Step 1/3 : FROM archlinux:latest
latest: Pulling from library/archlinux
no matching manifest for linux/arm64/v8 in the manifest list entries
----

We need to specify the platform:

[source,shell-session]
----
$ docker build --tag hello:latest --file ./Dockerfile1 .

$ docker run hello:latest 
WARNING: The requested image's platform (linux/amd64) does not match
the detected host platform (linux/arm64/v8) and no specific platform
was requested
It works!

docker [go-1.23.1] 
$ docker run --platform=linux/x86_64 hello:latest
It works!
----

* https://stackoverflow.com/questions/65456814/docker-apple-silicon-m1-preview-mysql-no-matching-manifest-for-linux-arm64-v8

